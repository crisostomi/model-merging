core:
  project_name: model_merging
  storage_dir: ${oc.env:PROJECT_ROOT}/storage
  entity: gladia
  version: 0.0.1
  tags: 
  - dev
  
defaults:
  - hydra: default
  - nn: default
  - train: default
  - merger: tsv # iso-c, consensus
  - benchmark: N20 # N14, N8
  - override hydra/launcher: basic # basic
  - override hydra/job_logging: none
  - override hydra/hydra_logging: none
  - _self_ # as last argument to allow the override of parameters via this main config

seed_index: 0
num_tasks: ???
eval_on_train: false
number_of_train_batches: 25 # number of batches of the val set, used for grid search
device: 'cuda'

conventions:
  x_key: 'x'
  y_key: 'y'

# compression_ratio = 1 / svd_compress_factor, if null the ratio is set to 1 / num_tasks
svd_compress_factor: null

misc:
  ckpt_path: ${oc.env:MODELS_PATH}/${nn.encoder.model_name}
  pretrained_checkpoint: ${misc.ckpt_path}/base/model.pt
  openclip_cachedir: "${oc.env:MODELS_PATH}/openclip_cache/"
  checkpoint_dir: ${oc.env:MODELS_PATH}/linear_router
  svd_path: "${oc.env:MODELS_PATH}/svd_dict_${nn.encoder.model_name}.pt"
  finetuned_accuracy_path: "${oc.env:PROJECT_ROOT}/results/finetuning/accs.json"
  results_path: "${oc.env:PROJECT_ROOT}/results/${nn.encoder.model_name}/"